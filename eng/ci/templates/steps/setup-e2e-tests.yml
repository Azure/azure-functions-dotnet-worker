parameters:
  - name: DotnetVersion
    type: string
    default: 'net7'
  - name: UseCoreToolsBuild
    type: string
    default: 'False'
  - name: SkipStorageEmulator
    type: boolean
    default: false
  - name: SkipCosmosDBEmulator
    type: boolean
    default: false
  - name: SkipCoreTools
    type: boolean
    default: false
  - name: SkipBuildOnPack
    type: boolean
    default: false
  - name: CoreToolsUrl
    type: string

steps:

- task: PowerShell@2
  displayName: 'Setup E2E tests'
  inputs:
    targetType: filePath
    filePath: setup-e2e-tests.ps1
    arguments: >
      -DotnetVersion ${{ parameters.DotnetVersion }}
      -SkipStorageEmulator:$${{ parameters.SkipStorageEmulator }}
      -SkipCosmosDBEmulator:$${{ parameters.SkipCosmosDBEmulator }}
      -SkipCoreTools:$${{ parameters.SkipCoreTools }}
      -UseCoreToolsBuildFromIntegrationTests:$${{ parameters.UseCoreToolsBuild }}
      -SkipBuildOnPack:$${{ parameters.SkipBuildOnPack }}
    pwsh: true
  env:
      CORE_TOOLS_URL: ${{ parameters.CoreToolsUrl }}
      CORE_TOOLS_URL_LINUX: ${{ parameters.CoreToolsUrl }}
