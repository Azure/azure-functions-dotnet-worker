<Project Sdk="Microsoft.Build.NoTargets">

  <PropertyGroup>
    <!-- TFM and RId are actually used. -->
    <TargetFrameworks>net6.0;net8.0</TargetFrameworks>
    <RuntimeIdentifier>win</RuntimeIdentifier>
    <CustomAfterNoTargets Condition="'$(TargetFramework)' != ''">$(MSBuildThisFileDirectory)Publish.SingleTFM.targets</CustomAfterNoTargets>
    <CustomAfterNoTargets Condition="'$(TargetFramework)' == ''">$(MSBuildThisFileDirectory)Publish.MultiTFM.targets</CustomAfterNoTargets>
    <AddAdditionalExplicitAssemblyReferences>false</AddAdditionalExplicitAssemblyReferences>
    <ShouldWriteHardLinkHashes>false</ShouldWriteHardLinkHashes>
  </PropertyGroup>

  <PropertyGroup Condition="'$(TargetFramework)' == 'net6.0'">
    <SiteExtensionName>FunctionsInProc</SiteExtensionName>
  </PropertyGroup>

  <PropertyGroup Condition="'$(TargetFramework)' == 'net8.0'">
    <SiteExtensionName>FunctionsInProc8</SiteExtensionName>
  </PropertyGroup>
  
  <Import Project="$(WorkersProps)" />

  <ItemGroup>
    <ProjectReference Include="../WebJobs.Script.WebHost/WebJobs.Script.WebHost.csproj" ReferenceOutputAssembly="false" />
  </ItemGroup>

  <ItemGroup>
    <!-- This item group controls what runtimes we will publish for public & private site extension -->
    <PublishRuntimeIdentifier Include="win-x86" SelfContained="false" PublishDir="32bit" />
    <PublishRuntimeIdentifier Include="win-x64" SelfContained="false" PublishDir="64bit" />
  </ItemGroup>

  <ItemGroup>
    <None Include="$(RepoRoot)/release_notes.md" CopyToPublishDirectory="PreserveNewest" />
    <None Include="**/*.ps1" Exclude="New-ReleaseJson.ps1" CopyToPublishDirectory="PreserveNewest" />
  </ItemGroup>

</Project>
